const settings = Object.assign({}, userSettings);

const AdminSettings = {
    // Settings INIT
    AdminSettingsInit() {
        this.LoadSavedSettings();
        this.ManageThemeLayout();
        this.ManageSidebarType();
        this.ManageDarkThemeLayout();
    },

    // Load saved settings from localStorage
    LoadSavedSettings() {
        const savedTheme = localStorage.getItem("selectedTheme");
        if (savedTheme) {
            settings.Theme = savedTheme;
        }
    },
    
    // Vertical Layout only
    ManageThemeLayout() {
        document.documentElement.setAttribute("data-layout", "vertical");
    },

    // Full / Mini Sidebar Type
    ManageSidebarType() {
        switch (settings.SidebarType) {
            case "full":
                const fullSidebarElement =
                    document.querySelector("#full-sidebar");
                if (fullSidebarElement) {
                    fullSidebarElement.checked = true;
                }
                document.body.setAttribute("data-sidebartype", "full");

                const setSidebarType = () => {
                    const width =
                        window.innerWidth > 0
                            ? window.innerWidth
                            : screen.width;
                    if (width < 1300) {
                        document.body.setAttribute(
                            "data-sidebartype",
                            "mini-sidebar"
                        );
                    } else {
                        document.body.setAttribute("data-sidebartype", "full");
                    }
                };
                window.addEventListener("DOMContentLoaded", setSidebarType);
                window.addEventListener("resize", setSidebarType);
                break;

            case "mini-sidebar":
                const miniSidebarElement =
                    document.querySelector("#mini-sidebar");
                if (miniSidebarElement) {
                    miniSidebarElement.checked = true;
                }
                document.body.setAttribute("data-sidebartype", "mini-sidebar");
                break;

            default:
                break;
        }
    },

    // Theme Dark or Light
    ManageDarkThemeLayout() {
        const setTheme = (theme, hideElements, showElements, hideElements2) => {
            document.documentElement.setAttribute("data-bs-theme", theme);
            localStorage.setItem("selectedTheme", theme); // Save the theme to localStorage
            const themeLayoutElement = document.getElementById(
                `${theme}-layout`
            );
            if (themeLayoutElement) {
                themeLayoutElement.checked = true;
            }

            hideElements.forEach((el) =>
                document
                    .querySelectorAll(`.${el}`)
                    .forEach((e) => (e.style.display = "none"))
            );
            showElements.forEach((el) =>
                document
                    .querySelectorAll(`.${el}`)
                    .forEach((e) => (e.style.display = "flex"))
            );
            hideElements2.forEach((el) =>
                document
                    .querySelectorAll(`.${el}`)
                    .forEach((e) => (e.style.display = "none"))
            );
        };

        switch (settings.Theme) {
            case "light":
                setTheme("light", ["light-logo"], ["moon"], ["sun"]);
                break;
            case "dark":
                setTheme("dark", ["dark-logo"], ["sun"], ["moon"]);
                break;
            default:
                break;
        }
    },

};

// Initialize settings
AdminSettings.AdminSettingsInit();

// Handle Click
document.addEventListener("DOMContentLoaded", function () {

    // Theme mode Dark or Light
    function handleTheme() {
        function setThemeAttributes(
            theme,
            darkDisplay,
            lightDisplay,
            sunDisplay,
            moonDisplay
        ) {
            document.documentElement.setAttribute("data-bs-theme", theme);
            localStorage.setItem("selectedTheme", theme); // Save the theme to localStorage
            const themeLayoutElement = document.getElementById(
                `${theme}-layout`
            );
            if (themeLayoutElement) {
                themeLayoutElement.checked = true;
            }

            document
                .querySelectorAll(`.${darkDisplay}`)
                .forEach((el) => (el.style.display = "none"));
            document
                .querySelectorAll(`.${lightDisplay}`)
                .forEach((el) => (el.style.display = "flex"));
            document
                .querySelectorAll(`.${sunDisplay}`)
                .forEach((el) => (el.style.display = "none"));
            document
                .querySelectorAll(`.${moonDisplay}`)
                .forEach((el) => (el.style.display = "flex"));
        }

        document.querySelectorAll(".dark-layout").forEach((element) => {
            element.addEventListener("click", () =>
                setThemeAttributes(
                    "dark",
                    "dark-logo",
                    "light-logo",
                    "moon",
                    "sun"
                )
            );
        });

        document.querySelectorAll(".light-layout").forEach((element) => {
            element.addEventListener("click", () =>
                setThemeAttributes(
                    "light",
                    "light-logo",
                    "dark-logo",
                    "sun",
                    "moon"
                )
            );
        });
    }
    handleTheme();

    // Theme Sidebar
    function handleSidebarToggle() {
        function setSidebarType(sidebarType) {
            document.body.setAttribute("data-sidebartype", sidebarType);
        }

        const fullSidebarElement = document.getElementById("full-sidebar");
        const miniSidebarElement = document.getElementById("mini-sidebar");

        if (fullSidebarElement) {
            fullSidebarElement.addEventListener("click", () =>
                setSidebarType("full")
            );
        }
        if (miniSidebarElement) {
            miniSidebarElement.addEventListener("click", () =>
                setSidebarType("mini-sidebar")
            );
        }
    }
    handleSidebarToggle();

    // Toggle Sidebar
    function handleSidebar() {
        document.querySelectorAll(".sidebartoggler").forEach((element) => {
            element.addEventListener("click", function () {
                document.querySelectorAll(".sidebartoggler").forEach((el) => {
                    el.checked = true;
                });
                document
                    .getElementById("main-wrapper")
                    .classList.toggle("show-sidebar");
                document.querySelectorAll(".sidebarmenu").forEach((el) => {
                    el.classList.toggle("close");
                });
                const dataTheme =
                    document.body.getAttribute("data-sidebartype");
                if (dataTheme === "full") {
                    document.body.setAttribute(
                        "data-sidebartype",
                        "mini-sidebar"
                    );
                } else {
                    document.body.setAttribute("data-sidebartype", "full");
                }
            });
        });
    }
    handleSidebar();
    
});
